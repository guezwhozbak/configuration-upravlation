# Практическое занятие №5 "Вопросы виртуализации"
Выполнила **Рожкова Ольга**, группа **ИКБО-62-23** 
---
## Задача №1

Опишите по шагам, что делает каждая из следующих команд (приведите эквивалентное выражение на Python):

11 0 LOAD_FAST 0 (x) 2 LOAD_CONST 1 (10) 4 BINARY_MULTIPLY 6 LOAD_CONST 2 (42) 8 BINARY_ADD 10 RETURN_VALUE

### Решение
```py
11 0 LOAD_FAST 0 (x)
   2 LOAD_CONST 1 (10)
   4 BINARY_MULTIPLY
   6 LOAD_CONST 2 (42)
   8 BINARY_ADD
   10 RETURN_VALUE
```

#### **11 0 LOAD_FAST 0 (x)**

Загружает значение переменной x на вершину стека.
Эквивалент на Python: x

#### **2 LOAD_CONST 1 (10)**

Загружает константу 10 на вершину стека.
Эквивалент на Python: 10

#### **4 BINARY_MULTIPLY**

Выполняет операцию умножения: умножает два верхних значения стека.
Эквивалент на Python: x * 10

#### **6 LOAD_CONST 2 (42)**

Загружает константу 42 на вершину стека.
Эквивалент на Python: 42

#### **8 BINARY_ADD**

Выполняет операцию сложения: складывает два верхних значения стека.
Эквивалент на Python: (x * 10) + 42

#### **10 RETURN_VALUE**

Возвращает верхнее значение стека из функции.
Эквивалент на Python: return (x * 10) + 42

## Задача №2

Что делает следующий байткод (опишите шаги его работы)? Это известная функция, назовите ее.

### Решение
```py
  5           0 LOAD_CONST               1 (1) # Загружает константу 1 на вершину стека
              2 STORE_FAST               1 (r) # Сохраняет верхнее значение стека (1) в переменную r

  6     >>    4 LOAD_FAST                0 (n) # Загружает значение переменной n на вершину стека
              6 LOAD_CONST               1 (1) # Загружает константу 1 на вершину стека
              8 COMPARE_OP               4 (>) # Выполняет операцию сравнения: проверяет, больше ли верхнее значение стека (n) второго значения стека (1)
             10 POP_JUMP_IF_FALSE       30     # Снимает значение с вершины стека и переходит к адресу 30, если значение ложно (False)

  7          12 LOAD_FAST                1 (r) # Загружает значение переменной r на вершину стека
             14 LOAD_FAST                0 (n) # Загружает значение переменной n на вершину стека
             16 INPLACE_MULTIPLY               # Выполняет операцию умножения на месте: умножает верхнее значение стека (r) на предпоследнее значение стека (n)
             18 STORE_FAST               1 (r) # Сохраняет верхнее значение стека в переменную r

  8          20 LOAD_FAST                0 (n) # Загружает значение переменной n на вершину стека
             22 LOAD_CONST               1 (1) # Загружает константу 1 на вершину стека
             24 INPLACE_SUBTRACT               # Выполняет операцию вычитания на месте: вычитает верхнее значение стека (1) из предпоследнего значения стека (n)
             26 STORE_FAST               0 (n) # Сохраняет верхнее значение стека в переменную n
             28 JUMP_ABSOLUTE            4     # Переходит к абсолютному адресу 4, что фактически возвращает выполнение к началу цикла

  9     >>   30 LOAD_FAST                1 (r) # Загружает значение переменной r на вершину стека
             32 RETURN_VALUE                   # Возвращает верхнее значение стека из функции
```

Этот байткод реализует функцию вычисления факториала числа n. 

Эквивалентное выражение на .py: 

```py
def factorial(n):
    r = 1
    while n > 1:
        r *= n
        n -= 1
    return r
```

## Задача №3 

Приведите результаты из задач 1 и 2 для виртуальной машины JVM (Java) или .Net (C#).

### Решение
#### Задача №1
Эквивалент на Java:
```java
public class Foo {
    public static int foo(int x) {
        while (x != 0) {
            x -= 1;
        }
        return x + 1;
    }
}
```
Байткод для Java:
```java
public class Foo {
    public static int foo(int);
      Code:
         0: iload_0          // Загружает значение переменной x на вершину стека
         1: ifeq          12 // Если значение на вершине стека равно 0, переходит к адресу 12
         4: iload_0          // Загружает значение переменной x на вершину стека
         5: iconst_1         // Загружает константу 1 на вершину стека
         6: isub             // Выполняет операцию вычитания: вычитает верхнее значение стека из предпоследнего значения стека
         7: istore_0         // Сохраняет верхнее значение стека в переменную x
         8: goto          0  // Переходит к адресу 0
        12: iload_0          // Загружает значение переменной x на вершину стека
        13: iconst_1         // Загружает константу 1 на вершину стека
        14: iadd             // Выполняет операцию сложения: складывает два верхних значения стека
        15: ireturn          // Возвращает верхнее значение стека из функции
}
```
#### Задача №2
Эквивалент на Java:
```java
public class Factorial {
    public static int factorial(int n) {
        int r = 1;
        while (n > 1) {
            r *= n;
            n -= 1;
        }
        return r;
    }
}
```
Байткод для Java:
```java
public class Factorial {
    public static int factorial(int);
      Code:
         0: iconst_1         // Загружает константу 1 на вершину стека
         1: istore_1         // Сохраняет верхнее значение стека в переменную r
         2: iload_0          // Загружает значение переменной n на вершину стека
         3: iconst_1         // Загружает константу 1 на вершину стека
         4: if_icmple     20 // Если верхнее значение стека меньше или равно второму значению стека, переходит к адресу 20
         7: iload_1          // Загружает значение переменной r на вершину стека
         8: iload_0          // Загружает значение переменной n на вершину стека
         9: imul             // Выполняет операцию умножения: умножает два верхних значения стека
        10: istore_1         // Сохраняет верхнее значение стека в переменную r
        11: iload_0          // Загружает значение переменной n на вершину стека
        12: iconst_1         // Загружает константу 1 на вершину стека
        13: isub             // Выполняет операцию вычитания: вычитает верхнее значение стека из предпоследнего значения стека
        14: istore_0         // Сохраняет верхнее значение стека в переменную n
        15: goto          2  // Переходит к адресу 2
        18: iload_1          // Загружает значение переменной r на вершину стека
        19: ireturn          // Возвращает верхнее значение стека из функции
}
```
## Задача №4

Работа с qemu. Скачать и установить ISO-образ Alpine Linux для виртуальных машин с официального сайта. Создать с помощью qemu образ жесткого диска (опция -f qcow2). Объем диска 500 Мб. Запустить Alpine Linux с CD-ROM. Установить систему на sda. Изменить motd. Загрузиться уже с sda. Прислать полный список команд для установки и загрузки, а также скриншот с motd, где фигурируют ваши имя и фамилия.


### Решение

Создание образа жесткого диска:

![image](https://github.com/guezwhozbak/configuration-upravlation/blob/main/practice5/5-1.jpg)

Установка и загрузка:

![image](https://github.com/guezwhozbak/configuration-upravlation/blob/main/practice5/5-2.jpg)
![image](https://github.com/guezwhozbak/configuration-upravlation/blob/main/practice5/5-3.jpg)

motd:

![image](https://github.com/guezwhozbak/configuration-upravlation/blob/main/practice5/5-4.jpg)

